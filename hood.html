
<html>
<title>Hood Webcams</title>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f4f4f4;
	    flex-direction: column;
        }

	.footer {
            //background-color: blue;
	    height: 70px;
	}

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 10px;
            width: 100%;
        }

        .gallery-item {
            display: flex;
            flex-direction: column;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            background-color: #fff;
        }

        .spacer {
            flex-grow: 1;
        }

        .gallery a {
            display: block;
	    position: relative;
        }

        .gallery img {
            width: 100%;
            height: auto;
            object-fit: contain;
            display: block;
        }

.white-big {
 color: white;
 font-size: 50px;
}
.bottom-left {
  position: absolute;
  bottom: 8px;
  left: 16px;
}

</style>
<div id="images" class="gallery"></div>
<script type="text/javascript">
// Got Meadows urls from: https://www.skihood.com/mountain-report

	var images = [
	[ "Stake   ", "https://www.timberlinelodge.com/snowcameras/snowstake.jpg" ],
	[ "Mile    ", "https://www.timberlinelodge.com/snowcameras/FloodEast.jpg" ],
	[ "Palmer  ", "https://www.timberlinelodge.com/snowcameras/palmerbottom.jpg" ],
	[ "TLodge  ", "https://www.timberlinelodge.com/snowcameras/lodge.jpg" ],
	[ "Bruno   ", "https://www.timberlinelodge.com/snowcameras/brunotop.jpg" ],
	[ "Summit  ", "https://www.timberlinelodge.com/snowcameras/summit.jpg" ],
	[ "Pucci   ", "https://www.timberlinelodge.com/snowcameras/pucci.jpg" ],
//	[ "MdwStake2", "https://b9.hdrelay.com/camera/63cadf1f426d0a9136dc81da/snapshot" ],
	[ "MdwStake3", "https://b15.hdrelay.com/camera/63cadf1f426d0a9136dc81da/snapshot" ],
	[ "        ", "https://telemetry.skihood.com/cams/base" ],
	[ "        ", "https://telemetry.skihood.com/cams/top" ],
	[ "        ", "https://telemetry.skihood.com/cams/vista" ],
	//[ "        ", "https://telemetry.skihood.com/cams/vstop" ],
	[ "        ", "https://api.wetmet.net/widgets/image/frame.php?uid=b33acd75e0ba216558a38590f4d924ae&type=image&format=image.jpg" ],
	[ "        ", "https://api.wetmet.net/widgets/image/frame.php?uid=c5a90b27806182f3b7b31fc9a79d6e7e&type=image&format=image.jpg" ],
// old broken ones:
//	[ "        ", "https://telemetry.skihood.com/cams/sahale" ],
//	[ "MdwStake1", "https://img.hdrelay.com/snapshots/63cadf1f426d0a9136dc81da/1701450503160.jpg" ],
	];

	// Put a random url bit on all the webcams:
	var now = Date.now();
	for (var i = 0; i < images.length; i++) {
		images[i][1] = images[i][1] + "?random=" + now;
	}

	for (var i = 0; i <= 96; i+= 48) {
		url = "https://forecast.weather.gov/meteograms/Plotter.php?lat=45.3293&lon=-121.7098&wfo=PQR&zcode=ORZ126&gset=18&gdiff=3&unit=0&tinfo=PY8&" +
		      "ahour=" + i +
		      "&pcmd=11010000101000000000000000000000000000000000000000000000000&lg=en&indu=1!1!1!&dd=&bw=&hrspan=48&pqpfhr=6&psnwhr=6";
		//console.log(i + ": " + url);
		var entry = [ "", url ];
		images.push(entry);
	}


	//var d = document.evaluate("//img", document, null, XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null);
	var d = document.getElementById("images");
	d.classList.add("images");
	var debug = true;
	debug = false;
	for (var i = 0; i < images.length; i++) {
		var item   = document.createElement("div");
		var spacer = document.createElement("div");
		var a      = document.createElement("a");
		var img    = document.createElement("img");
		var txt    = document.createElement("div");
		a.classList.add("container");
		a.classList.add("container");
		item.classList.add("gallery-item");
		spacer.classList.add("spacer");
		txt.classList.add("bottom-left");
		txt.classList.add("white-big");
		txt.innerHTML = images[i][0];
		//img.width = "100%";
		url = images[i][1];
		a.href  = url;
		img.addEventListener('error', function () {
		    console.warn(`Image failed to load: ${this.src}`);

		    // Avoid infinite reload loops
		    if (!this.dataset.reloaded) {
		      this.dataset.reloaded = 'true'; // Mark as reloaded
		      this.src = this.src; // Trigger reload by re-assigning the source
		    } else {
		      console.error(`Image reload failed: ${this.src}`);
		    }
		});
		img.src = url;
		//img.width = "700";
		if (debug) {
			a.innerHTML = "linktext";
			a.style.background = "red";
			spacer.style.background = "purple";
			spacer.innerHTML = "topfiller";
		}
		a.appendChild(img);
		a.appendChild(txt);
		item.appendChild(spacer);
		item.appendChild(a);
		d.appendChild(item);
	}
</script>
<div class="footer"></div>
</html>
